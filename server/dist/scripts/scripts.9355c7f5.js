"use strict";angular.module("clientApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.router","ui.bootstrap","firebase"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/home"),a.state("home",{url:"/home",templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).state("about",{url:"/about",templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).state("points",{url:"/points",templateUrl:"views/search.html",controller:"SearchCtrl",controllerAs:"search"}).state("user",{url:"/user/:id/view",templateUrl:"views/user.html",controller:"UserCtrl",controllerAs:"user"}).state("events",{url:"/events/view",templateUrl:"views/events.html",controller:"EventsCtrl",controllerAs:"events"})}]).constant("FIREBASE_URL","https://westie.firebaseio.com"),angular.module("clientApp").factory("WCSUser",["$resource",function(a){return a("/api/user/:id")}]).factory("User",["FIREBASE_URL","$firebaseArray","$firebaseObject",function(a,b,c){return{forUser:function(b){var c=new Firebase(a+"/users/"+b);return c}}}]),angular.module("clientApp").factory("WCSEvents",["$resource",function(a){return a("/api/events/:id",null,{query:{method:"GET",params:{id:"id"},isArray:!1},get:{method:"GET"}})}]),angular.module("clientApp").factory("AuthSvc",["FIREBASE_URL","$firebaseAuth",function(a,b){var c=new Firebase(a),d=b(c),e=d.$getAuth();return{forAuth:function(){return d},forDisplay:function(){if(e){var a={firstname:e.facebook.cachedUserProfile.first_name||"",lastname:e.facebook.cachedUserProfile.last_name||"",displayName:e.facebook.displayName||"",pictureURL:e.facebook.cachedUserProfile.picture.data.url||""};return a}return null}}}]),angular.module("clientApp").controller("MainCtrl",["$location","$state","AuthSvc","User",function(a,b,c,d){var e=this;this.isLoggedIn=function(){return c.forAuth().$getAuth()},this.profileInfo=c.forDisplay(),this.logout=function(){c.forAuth().$unauth(),b.go("home")},this.login=function(){c.forAuth().$authWithOAuthPopup("facebook").then(function(a){console.log("Logged in as:",a.uid),d.forUser(a.facebook.cachedUserProfile.id).once("value",function(b){b.exists()||(console.log("user did not exist"),d.forUser(a.facebook.cachedUserProfile.id).set({firstname:a.facebook.cachedUserProfile.first_name,lastname:a.facebook.cachedUserProfile.last_name,displayName:a.facebook.displayName,pictureURL:a.facebook.cachedUserProfile.picture.data.url}))}),e.profileInfo=c.forDisplay()})["catch"](function(a){console.error("Authentication failed:",a)})}}]),angular.module("clientApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("clientApp").controller("SearchCtrl",["$http",function(a){this.getWestie=function(b){return a.get("/api/userList/"+b).then(function(a){return a.data})},this.setWestie=function(a){this.selectedUser=a.value}}]),angular.module("clientApp").controller("UserCtrl",["$stateParams","WCSUser",function(a,b){this.data=b.get({id:a.id}),this.dancer=angular.fromJson(this.data),this.results=this.dancer.results,console.log(),console.log(this.data.results)}]),angular.module("clientApp").controller("EventsCtrl",["WCSEvents",function(a){var b=this;b.data=a.get(),b.events=angular.fromJson(this.data),b.results=b.events.results,console.log(b.results)}]),angular.module("testApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/events.html",'<div class row> <table class="table table-striped"> <caption style="font-weight:bold;font-style:italic">Upcoming Events</caption> <div class="col-lg-6 col-lg-offset-6"> <div class="input-group"> <input type="text" ng-model="events.query" class="form-control" placeholder="Search for..."> </div><!-- /input-group --> </div><!-- /.col-lg-6 --> <thead> <tr> <th>Date</th> <th>Name</th> <th>Location</th> <th>Contact</th> <th>Ticket</th> </tr> </thead> <tbody> <tr ng-repeat="e in events.events.results | filter:events.query"> <td>{{e.eventdate}}</td> <td><a ng-href="{{e.event}}"> {{e[\'event/_text\']}}</a></td> <td>{{e.eventlocation}}</td> <td><a ng-href="{{e.eventperson}}">{{e[\'eventperson/_text\']}}</a></td> <td>{{e.ticketperson}}</td> </tr> </tbody> </table> <!--{{events.events.results.collection1}}--> </div>'),a.put("views/main.html",'<div id="myCarousel" class="carousel slide" data-ride="carousel"> <!-- Indicators --> <ol class="carousel-indicators"> <li data-target="#myCarousel" data-slide-to="0" class="active"></li> <li data-target="#myCarousel" data-slide-to="1"></li> <li data-target="#myCarousel" data-slide-to="2"></li> </ol> <div class="carousel-inner" role="listbox"> <div class="item active"> <img class="homeCarouselImg" src="../images/c.4c08359d.jpg" alt="First slide"> <div class="container"></div> </div> <div class="item"> <img class="homeCarouselImg" src="../images/c1.d6ae9ae7.jpg" alt="Second slide"> </div> <div class="item"> <img class="homeCarouselImg" src="../images/c2.5767b3f0.jpg" alt="Third slide"> </div> </div> <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> <span class="sr-only">Previous</span> </a> <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next"> <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span> <span class="sr-only">Next</span> </a> </div><!-- /.carousel -->'),a.put("views/search.html",'<div> <!--<form class="form-horizontal">--> <!--<input type="text" ng-model="search.wcsID">--> <!--<button class="btn" ui-sref="user({id:search.wcsID})"><i class="glyphicon-search"></i>Search</button>--> <!--</form>--> <h4>Points Search</h4> <!--<pre>Model: {{search.asyncSelected | json}}</pre>--> <div class="input-group"> <input type="text" ng-model="search.wcsID" placeholder="Search for a Westie..." uib-typeahead="westie as westie.label for westie in search.getWestie($viewValue)" typeahead-on-select="search.setWestie($item)" typeahead-loading="loadingLocations" typeahead-no-results="noResults" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" ui-sref="user({id:search.wcsID.value})"><i class="glyphicon-search"></i>Search</button> </span> </div> <i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i> <div ng-show="noResults"> <i class="glyphicon glyphicon-remove"></i> No Results Found </div> <br><br> </div>'),a.put("views/user.html",'<div> <h3>{{user.dancer[\'full_name\']}} </h3> <uib-tabset> <uib-tab heading="Leader"> <div class row> <table class="table table-striped" ng-repeat="division in user.dancer.results[0].divisions"> <caption style="font-weight:bold;font-style:italic">{{division.name}}</caption> <thead> <tr> <th>Event</th> <th>Location</th> <th>Date</th> <th>Result</th> <th>Points</th> </tr> </thead> <tbody> <tr ng-repeat="lplacement in division.leader_placements"> <td width="30%">{{lplacement.name}}</td> <td width="30%">{{lplacement.location}}</td> <td width="20%">{{lplacement.start_date | limitTo: 10 }}</td> <td width="10%">{{lplacement.result}}</td> <td width="10%">{{lplacement.points}}</td> </tr> </tbody> </table> </div> </uib-tab> <uib-tab heading="Follower"> <div class row> <table class="table table-striped" ng-repeat="division in user.dancer.results[0].divisions"> <caption style="font-weight:bold;font-style:italic">{{division.name}}</caption> <thead> <tr> <th>Event</th> <th>Location</th> <th>Date</th> <th>Result</th> <th>Points</th> </tr> </thead> <tbody> <tr ng-repeat="lplacement in division.follower_placements"> <td width="30%">{{lplacement.name}}</td> <td width="30%">{{lplacement.location}}</td> <td width="20%">{{lplacement.start_date}}</td> <td width="10%">{{lplacement.result}}</td> <td width="10%">{{lplacement.points}}</td> </tr> </tbody> </table> </div> </uib-tab> </uib-tabset> </div>')}]);